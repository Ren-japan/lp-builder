<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ site.title }} │ {{ site.subtitle }}</title>
<style>
/* === Reset === */
*, *::before, *::after { box-sizing: border-box; }
html, body, h1, h2, h3, h4, p, a, ul, li, dl, dd, dt, table, tr, td, th { margin: 0; padding: 0; }
a { text-decoration: none; color: inherit; }
li { list-style: none; }
img { max-width: 100%; height: auto; vertical-align: bottom; }

/* === Variables === */
:root {
  --main: {{ colors.main }};
  --sub: {{ colors.sub }};
  --text: {{ colors.text }};
  --bg: {{ colors.bg }};
  --white: {{ colors.white }};
  --accent: {{ colors.accent }};
}

/* === Base === */
body {
  font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', sans-serif;
  color: var(--text);
  background: #f9f9f5;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
}
.inner { max-width: 780px; margin: 0 auto; padding: 0 16px; }

/* === Header === */
.header { background: var(--white); border-bottom: 1px solid #eee; padding: 8px 16px; display: flex; align-items: center; justify-content: space-between; }
.header__logo { font-size: 18px; font-weight: 700; color: var(--text); }
.header__logo img { height: 32px; object-fit: contain; }
.header__ad { font-size: 12px; color: #999; border: 1px solid #ccc; padding: 2px 8px; border-radius: 3px; }

/* === Hero === */
.hero { position: relative; background: #3a2a1a; color: var(--white); overflow: hidden; }
.hero__bg { width: 100%; height: 400px; object-fit: cover; display: block; }
.hero__overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(0,0,0,0.35); padding: 24px; text-align: center; }
.hero__title { font-size: 48px; font-weight: 900; line-height: 1.2; text-shadow: 2px 2px 8px rgba(0,0,0,0.7); white-space: pre-line; }
.hero__catch { font-size: 28px; font-weight: 900; color: #ff4444; background: var(--white); border-radius: 50%; width: 120px; height: 120px; display: flex; align-items: center; justify-content: center; text-align: center; position: absolute; left: 24px; top: 50%; transform: translateY(-50%); line-height: 1.2; white-space: pre-line; }
.hero__sub { font-size: 36px; font-weight: 900; color: #DAA520; margin-top: 8px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
.hero__badges { display: flex; gap: 16px; margin-top: 20px; }
.hero__badge { background: linear-gradient(135deg, #DAA520, #B8860B); color: var(--white); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; text-align: center; white-space: pre-line; border: 3px solid #fff3; }

/* === Section Common === */
.section { margin-top: 32px; }
.section__heading { text-align: center; font-size: 24px; font-weight: 900; color: var(--text); padding: 16px 0; white-space: pre-line; line-height: 1.4; }
.section__heading span { color: var(--main); }

/* === Comparison Top === */
.comp-top { background: var(--white); border-radius: 12px; padding: 24px 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); }
.comp-table { width: 100%; border-collapse: collapse; margin-top: 16px; }
.comp-table th, .comp-table td { border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px; }
.comp-table th { background: var(--bg); font-weight: 700; width: 80px; }
.comp-table td { vertical-align: middle; }
.comp-table__logo { height: 36px; object-fit: contain; display: block; margin: 0 auto 8px; }
.comp-table__link { color: var(--main); font-weight: 700; text-decoration: underline; font-size: 13px; }
.rating-icon { display: block; margin: 0 auto 4px; width: 32px; height: 32px; border-radius: 50%; line-height: 32px; font-size: 18px; font-weight: 900; }
.rating-icon--dc { background: var(--main); color: var(--white); }
.rating-icon--c { background: #DAA520; color: var(--white); }
.rating-icon--t { background: #999; color: var(--white); }
.cta-btn-sm { display: block; background: var(--sub); color: var(--white); padding: 10px 8px; border-radius: 8px; font-weight: 700; font-size: 13px; text-align: center; margin-top: 8px; transition: opacity 0.2s; }
.cta-btn-sm:hover { opacity: 0.85; }

/* === Detail Table === */
.detail-tbl { background: var(--white); border-radius: 12px; padding: 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); overflow-x: auto; }
.detail-tbl table { width: 100%; border-collapse: collapse; min-width: 600px; }
.detail-tbl th, .detail-tbl td { border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 13px; }
.detail-tbl th { background: var(--bg); font-weight: 700; }
.detail-tbl td:first-child { font-weight: 700; background: var(--bg); width: 120px; }
.detail-tbl__note { font-size: 12px; color: #888; margin-top: 8px; text-align: right; }

/* === Shop Card === */
.shop-card { background: var(--white); border-radius: 12px; padding: 0; margin-top: 24px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); overflow: hidden; }
.shop-card__head { background: var(--bg); padding: 16px 20px; display: flex; align-items: center; gap: 16px; border-bottom: 3px solid var(--main); }
.shop-card__rank { font-size: 36px; font-weight: 900; color: var(--main); min-width: 48px; text-align: center; }
.shop-card__rank--1 { color: #DAA520; }
.shop-card__rank--2 { color: #888; }
.shop-card__rank--3 { color: #a0522d; }
.shop-card__info-head { flex: 1; }
.shop-card__catch { font-size: 14px; color: var(--main); font-weight: 700; }
.shop-card__name { font-size: 22px; font-weight: 900; margin-top: 4px; }
.shop-card__sub-catch { font-size: 13px; color: #666; white-space: pre-line; margin-top: 4px; }
.shop-card__body { padding: 20px; }

/* Info Table */
.info-table { width: 100%; border-collapse: collapse; }
.info-table th, .info-table td { border: 1px solid #eee; padding: 8px 12px; font-size: 13px; }
.info-table th { background: var(--bg); width: 100px; font-weight: 600; text-align: left; }
.info-table td { white-space: pre-line; }

/* Features */
.shop-features { margin-top: 20px; }
.shop-feature { margin-top: 16px; }
.shop-feature__title { font-size: 16px; font-weight: 700; color: var(--text); padding-bottom: 4px; border-bottom: 2px solid var(--main); display: inline-block; }
.shop-feature__text { font-size: 14px; margin-top: 8px; white-space: pre-line; line-height: 1.7; }
.shop-feature__img { margin-top: 12px; border-radius: 8px; max-width: 100%; }

/* Reviews */
.shop-reviews { margin-top: 20px; background: var(--bg); border-radius: 8px; padding: 16px; }
.shop-reviews__title { font-size: 14px; font-weight: 700; margin-bottom: 12px; }
.shop-review { background: var(--white); padding: 12px; border-radius: 6px; font-size: 13px; line-height: 1.6; margin-top: 8px; border-left: 3px solid var(--accent); }

/* Campaign */
.shop-campaign { margin-top: 20px; border: 2px solid var(--main); border-radius: 8px; padding: 16px; text-align: center; }
.shop-campaign__title { font-size: 14px; font-weight: 700; color: var(--main); }
.shop-campaign__sub { font-size: 13px; color: var(--main); margin-top: 4px; }

/* Extra Images */
.shop-extra-images { margin-top: 16px; display: flex; flex-wrap: wrap; gap: 12px; }
.shop-extra-images img { border-radius: 8px; max-width: 100%; }

/* CTA */
.cta-btn { display: block; background: var(--sub); color: var(--white); text-align: center; padding: 16px 24px; border-radius: 10px; font-size: 18px; font-weight: 700; margin-top: 16px; transition: opacity 0.2s; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
.cta-btn:hover { opacity: 0.85; }
.cta-sub { text-align: center; font-size: 14px; color: var(--main); font-weight: 700; margin-top: 12px; }

/* === Flow === */
.flow-section { background: var(--white); border-radius: 12px; padding: 24px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); }
.flow-items { display: flex; flex-direction: column; gap: 0; margin-top: 16px; }
.flow-item { display: flex; align-items: flex-start; gap: 16px; padding: 16px 0; position: relative; }
.flow-item + .flow-item { border-top: none; }
.flow-item + .flow-item::before { content: "▼"; position: absolute; top: -12px; left: 28px; font-size: 18px; color: var(--main); }
.flow-item__icon { font-size: 32px; min-width: 56px; height: 56px; display: flex; align-items: center; justify-content: center; background: var(--bg); border-radius: 50%; overflow: hidden; }
.flow-item__icon img { width: 40px; height: 40px; object-fit: contain; }
.flow-item__content { flex: 1; }
.flow-item__title { font-size: 16px; font-weight: 700; }
.flow-item__text { font-size: 13px; color: #666; margin-top: 4px; }

/* === Summary Table === */
.summary-section { margin-top: 32px; }
.summary-tbl { background: var(--white); border-radius: 12px; padding: 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); overflow-x: auto; }
.summary-tbl table { width: 100%; border-collapse: collapse; min-width: 600px; }
.summary-tbl th, .summary-tbl td { border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 13px; vertical-align: top; white-space: pre-line; }
.summary-tbl th { background: var(--bg); font-weight: 700; }
.summary-tbl td:first-child { font-weight: 700; width: 120px; }

/* === Footer === */
.footer { background: var(--text); color: var(--white); padding: 32px 16px; margin-top: 48px; }
.footer__links { display: flex; flex-wrap: wrap; gap: 24px; justify-content: center; margin-bottom: 16px; }
.footer__link { font-size: 13px; color: #ccc; }
.footer__link:hover { color: var(--white); text-decoration: underline; }
.footer__copy { text-align: center; font-size: 12px; color: #888; margin-top: 16px; }

/* === Responsive === */
@media (max-width: 768px) {
  .hero__title { font-size: 32px; }
  .hero__sub { font-size: 24px; }
  .hero__catch { width: 90px; height: 90px; font-size: 20px; left: 12px; }
  .hero__badge { width: 64px; height: 64px; font-size: 12px; }
  .hero__bg { height: 300px; }
  .comp-table { font-size: 12px; }
  .shop-card__name { font-size: 18px; }
  .cta-btn { font-size: 16px; padding: 14px 16px; }
}
</style>
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="header__logo">
    {% if site.logo_url %}
    <img src="{{ site.logo_url }}" alt="{{ site.logo_text }}">
    {% else %}
    {{ site.logo_text }}
    {% endif %}
  </div>
  <span class="header__ad">{{ site.ad_label }}</span>
</header>

{% if sections_visibility.hero %}
<!-- Hero -->
<section class="hero" data-section="hero">
  {% if hero.bg_image_url %}
  <img class="hero__bg" src="{{ hero.bg_image_url }}" alt="">
  {% else %}
  <div class="hero__bg" style="background: linear-gradient(135deg, #3a2a1a, #1a1a2e);"></div>
  {% endif %}
</section>
{% endif %}

{% if sections_visibility.comparison_top %}
<!-- Comparison Top -->
<section class="section" data-section="comparison_top">
  <div class="inner">
    <div class="section__heading">{{ comparison_top.heading }}</div>
    <div class="comp-top">
      <table class="comp-table">
        <tr>
          <th>買取業者</th>
          {% for shop in comparison_top.shops %}
          <td>
            {% if shop.logo_url %}<img class="comp-table__logo" src="{{ shop.logo_url }}" alt="{{ shop.name }}">{% endif %}
            <a class="comp-table__link" href="{{ shop.link }}">{{ shop.name }}＞</a>
          </td>
          {% endfor %}
        </tr>
        {% for i in range(comparison_top.shops[0].metrics|length) %}
        <tr>
          <th>{{ comparison_top.shops[0].metrics[i].label }}</th>
          {% for shop in comparison_top.shops %}
          <td>
            {% if shop.metrics[i].rating == 'double_circle' %}
            <span class="rating-icon rating-icon--dc">◎</span>
            {% elif shop.metrics[i].rating == 'circle' %}
            <span class="rating-icon rating-icon--c">○</span>
            {% else %}
            <span class="rating-icon rating-icon--t">△</span>
            {% endif %}
            {{ shop.metrics[i].value }}
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
        <tr>
          <th>公式サイト</th>
          {% for shop in comparison_top.shops %}
          <td>
            <a class="cta-btn-sm" href="{{ shop.link }}">{{ shop.cta_text }}</a>
          </td>
          {% endfor %}
        </tr>
      </table>
    </div>
  </div>
</section>
{% endif %}

{% if sections_visibility.recommend_section %}
<!-- Recommend Section -->
<section class="section" data-section="recommend_section">
  <div class="inner">
    <div class="section__heading">{{ recommend_section.heading }}</div>
  </div>
</section>
{% endif %}

{% if sections_visibility.detail_table %}
<!-- Detail Table -->
<section class="section" data-section="detail_table">
  <div class="inner">
    <div class="detail-tbl">
      <table>
        <tr>
          <th></th>
          {% for col in detail_table.columns %}
          <th>{{ col }}</th>
          {% endfor %}
        </tr>
        {% for row in detail_table.rows %}
        <tr>
          <td>{{ row.label }}</td>
          {% for val in row.cells %}
          <td>{{ val }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </table>
      {% if detail_table.footer_note %}
      <div class="detail-tbl__note">{{ detail_table.footer_note }}</div>
      {% endif %}
    </div>
  </div>
</section>
{% endif %}

{% if sections_visibility.shops %}
<!-- Shop Cards -->
<section class="section" data-section="shops">
  <div class="inner">
    {% for shop in shops %}
    <div class="shop-card" id="{{ shop.id }}">
      <div class="shop-card__head">
        <div class="shop-card__rank shop-card__rank--{{ shop.rank }}">{{ shop.rank }}</div>
        <div class="shop-card__info-head">
          <div class="shop-card__catch">{{ shop.catch_copy }}</div>
          <div class="shop-card__name">{{ shop.name }}</div>
          <div class="shop-card__sub-catch">{{ shop.sub_catch }}</div>
        </div>
      </div>
      <div class="shop-card__body">
        <!-- Info Table -->
        {% if shop.visibility is not defined or shop.visibility.info is not defined or shop.visibility.info %}
        <table class="info-table">
          {% for key, val in shop.info.items() %}
          <tr><th>{{ key }}</th><td>{{ val }}</td></tr>
          {% endfor %}
        </table>
        {% endif %}

        <!-- Features -->
        {% if shop.visibility is not defined or shop.visibility.features is not defined or shop.visibility.features %}
        <div class="shop-features">
          {% for feat in shop.features %}
          <div class="shop-feature">
            <div class="shop-feature__title">{{ feat.title }}</div>
            <div class="shop-feature__text">{{ feat.text }}</div>
            {% if feat.image_url is defined and feat.image_url %}
            <img class="shop-feature__img" src="{{ feat.image_url }}" alt="">
            {% endif %}
          </div>
          {% endfor %}
        </div>
        {% endif %}

        <!-- Reviews -->
        {% if shop.visibility is not defined or shop.visibility.reviews is not defined or shop.visibility.reviews %}
        {% if shop.reviews %}
        <div class="shop-reviews">
          <div class="shop-reviews__title">口コミ</div>
          {% for review in shop.reviews %}
          <div class="shop-review">{{ review }}</div>
          {% endfor %}
        </div>
        {% endif %}
        {% endif %}

        <!-- Campaign -->
        {% if shop.visibility is not defined or shop.visibility.campaign is not defined or shop.visibility.campaign %}
        {% if shop.campaign %}
        <div class="shop-campaign">
          <div class="shop-campaign__title">{{ shop.campaign.text }}</div>
          <div class="shop-campaign__sub">{{ shop.campaign.sub_text }}</div>
          {% if shop.campaign.image_url %}
          <img src="{{ shop.campaign.image_url }}" alt="" style="margin-top:12px;max-width:100%;border-radius:8px;">
          {% endif %}
          <a class="cta-btn-sm" href="{{ shop.link }}" style="margin-top:12px;">{{ shop.name }} ＞</a>
        </div>
        {% endif %}
        {% endif %}

        <!-- Extra Images -->
        {% if shop.extra_images is defined and shop.extra_images %}
        <div class="shop-extra-images">
          {% for eimg in shop.extra_images %}
          {% if eimg %}
          <img src="{{ eimg }}" alt="">
          {% endif %}
          {% endfor %}
        </div>
        {% endif %}

        <!-- CTA -->
        {% if shop.visibility is not defined or shop.visibility.cta is not defined or shop.visibility.cta %}
        <div class="cta-sub">{{ shop.cta_sub }}</div>
        <a class="cta-btn" href="{{ shop.link }}">{{ shop.cta_text }}</a>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

{% if sections_visibility.flow %}
<!-- Flow -->
<section class="section" data-section="flow">
  <div class="inner">
    <div class="section__heading">{{ flow.heading }}</div>
    <div class="flow-section">
      <div class="flow-items">
        {% for step in flow.steps %}
        <div class="flow-item">
          <div class="flow-item__icon">
            {% if step.icon_type is defined and step.icon_type == '画像' and step.icon_image_url is defined and step.icon_image_url %}
            <img src="{{ step.icon_image_url }}" alt="">
            {% else %}
            {{ step.icon }}
            {% endif %}
          </div>
          <div class="flow-item__content">
            <div class="flow-item__title">{{ step.title }}</div>
            <div class="flow-item__text">{{ step.text }}</div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
{% endif %}

{% if sections_visibility.summary_table %}
<!-- Summary -->
<section class="section summary-section" data-section="summary_table">
  <div class="inner">
    <div class="section__heading">{{ summary_table.heading }}</div>
    <div class="summary-tbl">
      <table>
        <tr>
          <th>買取業者</th>
          <th>特徴</th>
          <th>買取範囲</th>
          <th>対応スピード</th>
          <th></th>
        </tr>
        {% for shop in summary_table.shops %}
        <tr>
          <td>{{ shop.name }}</td>
          <td>{{ shop.features }}</td>
          <td>{{ shop.scope }}</td>
          <td>{{ shop.speed }}</td>
          <td><a class="cta-btn-sm" href="{{ shop.link }}">{{ shop.cta_text }}</a></td>
        </tr>
        {% endfor %}
      </table>
    </div>
  </div>
</section>
{% endif %}

{% if sections_visibility.footer %}
<!-- Footer -->
<footer class="footer" data-section="footer">
  <div class="inner">
    <div class="footer__links">
      {% for link in footer.shop_links %}
      <a class="footer__link" href="{{ link.link }}">{{ link.name }}</a>
      {% endfor %}
      {% for link in footer.column_links %}
      <a class="footer__link" href="{{ link.link }}">{{ link.name }}</a>
      {% endfor %}
    </div>
    <div class="footer__copy">{{ footer.copyright }}</div>
  </div>
</footer>
{% endif %}

<!-- Section hover labels + click to jump -->
<style>
[data-section] { position: relative; cursor: pointer; transition: outline 0.15s; }
[data-section]:hover { outline: 2px solid rgba(0,120,255,0.5); outline-offset: 2px; }
[data-section]:hover::after {
  content: attr(data-label);
  position: absolute; top: 4px; right: 4px; z-index: 100;
  background: rgba(0,120,255,0.85); color: #fff; font-size: 11px; font-weight: 600;
  padding: 2px 8px; border-radius: 4px; pointer-events: none; white-space: nowrap;
}
</style>
<script>
(function(){
  var labels = {
    hero: 'ヒーロー', comparison_top: '比較表', recommend_section: 'おすすめ',
    detail_table: '詳細比較表', shops: '業者カード', flow: 'フロー',
    summary_table: 'まとめ比較', footer: 'フッター'
  };
  document.querySelectorAll('[data-section]').forEach(function(el){
    var key = el.getAttribute('data-section');
    el.setAttribute('data-label', labels[key] || key);
    el.addEventListener('click', function(e){
      e.preventDefault(); e.stopPropagation();
      window.parent.postMessage({type:'section-click', section: key}, '*');
    });
  });
})();
</script>
</body>
</html>
